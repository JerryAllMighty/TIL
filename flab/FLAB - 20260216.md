[서두]
- 실제 프로젝트를 진행하며 들었던 의문들인데, 질문으로 정리를 해서 훗날에 내가 이걸 제대로 이해하고 있는지
설명하는 테스트를 해보려 한다.
- 질문들을 보고 내가 어떤 고민들을 했는지도 같이 보는 사람도 의문을 가져볼 수 있다.

[내용]
<details>
<summary>**1. `@InjectMocks`가 `@Value/@PostConstruct` 안 부르는 이유?**</summary>
- Mockito는 Mock 주입만 함
- Spring 라이프사클(@Value 주입, @PostConstruct)은 무시
- **해결**: `ReflectionTestUtils.setField()` + 수동 `init()` 호출

**핵심**: Mockito ≠ Spring. SpringTest와 분리 이해!

</details>

<details>
<summary>**2. `Keys.hmacShaKeyFor()` 왜 필수인가?**</summary>
**질문**: JWT 키 변환 `hmacShaKeyFor()` 대안은 없나?     
**답변**:  
RFC 7518 §3.2: HS256은 **256bit+ 키** 필수
- 자동 길이 검증 + HMAC 설정
- SecretKeySpec 직접 → 런타임 보안 취약  
  **JJWT 공식**: "Always use Keys.hmacShaKeyFor()"

**핵심**: RFC 7518 표준 준수

</details>

<details>
<summary>**3. `@PostConstruct` 역할?**</summary>

**질문**: `init()`에서 SECRET_KEY 변환 이유?  
**답변**:  
Spring 빈 생명주기:
1. 생성자 → 2. @Value 주입 → **3. @PostConstruct**
- `@Value` 완료 후 안전 변환
- 생성자에서 하면 `secretKeyRaw = null` 문제

**핵심**: Spring 초기화 순서 이해!

</details>

<details>
<summary>**4. Unit vs Integration Test 기준?**</summary>

**질문**: LoginFilter 단위테스트 vs 통합테스트?  
**답변**:
- **Unit**: 순수 로직 (`Json 파싱 → attemptAuthentication()`)
- **Integration**: Spring 생명주기 (성공/실패 콜백)  
  테스트 피라미드: Unit 70% + Integration 20%

**핵심**: "고립 가능?" 기준으로 구분

</details>

<details>
<summary>**5. `any()` vs 정확 객체 verify?**</summary>

**질문**: `verify(authManager).authenticate(any())` vs `authRequest`?  
**답변**:
- `any()`: **어떤 인스턴스든** (메서드 호출 확인)
- `authRequest`: **메모리 주소 동일** (실패!)
- `argThat()`: 값만 확인 (최적)

**핵심**: Mockito 매처 이해

</details>

<details>
<summary>**6. `ResponseEntity.ofNullable(Optional)` 문제?**</summary>

**질문**: 컨트롤러에서 Optional 반환 OK?  
**답변**:  
❌ JSON 직렬화: `{"value": {...}, "present": true}`  
✅ 명시적: `ifPresent() → 200` / `notFound() → 404`  
**권장**: 서비스에서 `orElseThrow()` + 404 예외

**핵심**: REST 컨벤션 + 직렬화 이슈

</details>

<details>
<summary>**7. `StringUtils.hasText()` 내부?**</summary>

**질문**: `hasText()`가 null/빈/공백 체크?  
**답변**:  
`str != null && !str.isBlank()`  
| 입력 | 결과 |  
|------|------|  
| `null` | false |  
| `""` | false |  
| `" "` | false |  
| `"abc"` | true |

**핵심**: hasText 메서드는 3가지 다 체크한다

</details>

<details>
<summary>**8. 메서드 파라미터 `@Email` 어노테이션?**</summary>

**질문**: `createToken(@Email String email)` 가능?  
**답변**:  
❌ 컨트롤러 전용 (`@Valid` 필요)  
❌ 도메인에 Validation 의존성 (순수성 위배)  
✅ `StringUtils.hasText()` 명시적 검증

**핵심**: 책임 분리 (검증=호출자)

</details>

<details>
<summary>**9. 테스트 코드에서 문자열 포함 검증 방법?**</summary>
**질문**: assert로 문자열 포함 체크?  
**답변**:
```java
✅ Hamcrest: assertThat(msg, containsString("예상"))
✅ JUnit5: assertTrue(msg.contains("keyword"))
</details>